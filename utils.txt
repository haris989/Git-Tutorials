utility functions for version 3